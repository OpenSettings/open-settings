import{c as y}from"./chunk-7RH5RYQL.js";import{a as ct,b as st}from"./chunk-G6D4Y4OK.js";import{a as K}from"./chunk-NNDRUWYZ.js";import{B as et,C as it,D as nt,E as rt,F as ot,L as at,M as lt,N as mt,P as dt,b as G,d as M,f as O,g as D,j as z,l as R,n as q,p as U,r as W,t as Q,u as X,v as Y,w as Z,y as tt}from"./chunk-M66XJPMI.js";import{Da as u,Fa as l,Mb as T,Oa as o,Pa as r,Qa as b,S as v,Ua as I,Vb as A,Xa as h,Z as V,Za as m,_ as x,da as _,ea as g,fb as k,fc as B,g as E,gb as a,hb as w,ib as L,ic as C,jc as N,kd as $,mc as j,nc as F,nd as H,od as J,sa as s,ta as p,xb as P}from"./chunk-YYVWG2ID.js";function gt(i,e){if(i&1){let c=I();o(0,"div",6)(1,"button",7),h("click",function(){_(c);let t=m();return g(t.selectLogin("basic"))}),o(2,"mat-icon"),a(3,"vpn_key"),r(),a(4,"Basic"),r(),o(5,"button",8),h("click",function(){_(c);let t=m();return g(t.handleOauth())}),o(6,"mat-icon"),a(7,"enhanced_encryption"),r(),a(8,"OAuth"),r()()}}function ht(i,e){i&1&&(o(0,"mat-error",19),a(1,"Invalid GUID."),r())}function vt(i,e){i&1&&(o(0,"mat-error"),a(1,"Invalid GUID."),r())}function xt(i,e){if(i&1){let c=I();o(0,"button",20),h("click",function(){_(c);let t=m(3);return g(t.reset())}),a(1,"Back"),r()}}function bt(i,e){if(i&1){let c=I();o(0,"mat-card-content",6)(1,"form",10),h("ngSubmit",function(){_(c);let t=m(2);return g(t.onSubmit())}),o(2,"mat-form-field",11)(3,"mat-label"),a(4,"Client Id:"),r(),b(5,"input",12),u(6,ht,2,0,"mat-error",13),r(),o(7,"mat-form-field",11)(8,"mat-label"),a(9,"Client Secret:"),r(),b(10,"input",14),o(11,"button",15),h("click",function(){_(c);let t=m(2);return g(t.togglePasswordVisibility())}),o(12,"mat-icon"),a(13),r()(),u(14,vt,2,0,"mat-error",16),r(),o(15,"button",17),a(16,"Login"),r(),u(17,xt,2,0,"button",18),r()()}if(i&2){let c,n,t=m(2);s(),l("formGroup",t.form),s(5),l("ngIf",(c=t.form.get("clientId"))==null?null:c.hasError("invalidGuid")),s(4),l("type",t.hidePassword?"password":"text"),s(3),w(t.hidePassword?"visibility_off":"visibility"),s(),l("ngIf",(n=t.form.get("clientSecret"))==null?null:n.hasError("invalidGuid")),s(),l("disabled",t.form.invalid),s(2),l("ngIf",t.providerInfo==null||t.providerInfo.oAuth2==null?null:t.providerInfo.oAuth2.isActive)}}function It(i,e){if(i&1&&u(0,bt,18,7,"mat-card-content",9),i&2){let c=m();l("ngIf",c.selectedLogin)}}var ut=(()=>{let e=class e{constructor(n,t,d,f,S,_t){this.router=n,this.formBuilder=t,this.authService=d,this.snackBar=f,this.windowService=S,this.userPreferencesService=_t,this.hidePassword=!0,this.selectedLogin=null,this.subscriptions=new E}ngOnInit(){(this.authService.isAuthenticated||!this.authService.isAuthorizationRequired)&&this.router.navigate([""]),this.route=this.windowService.controllerOptions.route,this.providerInfo=this.windowService.providerInfo,this.serviceType=this.windowService.serviceType,this.packVersion=this.windowService.packVersion,this.providerInfo.oAuth2.isActive||(this.selectedLogin="basic"),this.form=this.formBuilder.group({clientId:["",[M.required,y.mustGuid]],clientSecret:["",[M.required,y.mustGuid]]})}ngOnDestroy(){this.subscriptions.unsubscribe()}selectLogin(n){this.selectedLogin=n}onSubmit(){this.form.valid&&this.login()}get clientId(){return this.form.get("clientId")?.value}get clientSecret(){return this.form.get("clientSecret")?.value}login(){let n=this.clientId,t=this.clientSecret;if(!n||!t)return;let d=this.authService.basicAuthorize(n,t).subscribe(f=>{if(f){this.router.navigate([""]);return}let S=f===!1?"Error: Credentials are not valid!":"Error: Exception occurred while the processing";this.snackBar.open(S,"Close",{horizontalPosition:"center",verticalPosition:"top",duration:2250})});this.subscriptions.add(d)}handleOauth(){let n=this.route+"/v1/auth/login";this.serviceType==="Consumer"&&(n+=`?uuid=${this.userPreferencesService.uuid}`),this.userPreferencesService.setAuth("oauth2"),window.location.href=n}reset(){this.selectedLogin=null,this.form.get("clientId")?.setValue(""),this.form.get("clientSecret")?.setValue("")}togglePasswordVisibility(){this.hidePassword=!this.hidePassword}};e.\u0275fac=function(t){return new(t||e)(p(B),p(U),p(F),p(K),p(N),p(j))},e.\u0275cmp=V({type:e,selectors:[["app-login"]],decls:10,vars:4,consts:[["basicLogin",""],[1,"login-container"],[1,"login-card"],[1,"login-title"],["class","mt-2",4,"ngIf","ngIfElse"],[1,"position-absolute","b-0","p-2","text-muted"],[1,"mt-2"],["mat-raised-button","","color","primary",1,"w-100",3,"click"],["mat-raised-button","","color","accent",1,"w-100","mt-2",3,"click"],["class","mt-2",4,"ngIf"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"mb-1"],["matInput","","type","text","formControlName","clientId"],["class","text-align-start",4,"ngIf"],["matInput","","formControlName","clientSecret",3,"type"],["mat-icon-button","","matSuffix","",3,"click"],[4,"ngIf"],["type","submit","mat-raised-button","","color","primary",1,"w-100",3,"disabled"],["mat-stroked-button","","color","warn","class","w-100 mt-2",3,"click",4,"ngIf"],[1,"text-align-start"],["mat-stroked-button","","color","warn",1,"w-100","mt-2",3,"click"]],template:function(t,d){if(t&1&&(o(0,"div",1)(1,"mat-card",2)(2,"mat-card-title",3),a(3),r(),b(4,"mat-divider"),u(5,gt,9,0,"div",4),r(),o(6,"div",5),a(7),r()(),u(8,It,1,1,"ng-template",null,0,P)),t&2){let f=k(9);s(3),w(d.selectedLogin?"Basic Authentication":"Please choose your preferred login"),s(2),l("ngIf",!d.selectedLogin)("ngIfElse",f),s(2),L("v",d.packVersion,"")}},dependencies:[T,z,G,O,D,R,q,$,H,Q,et,Y,Z,tt,nt,ot,rt,ct,lt],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh}.login-card[_ngcontent-%COMP%]{padding:30px;max-width:450px;width:100%;text-align:center;border-radius:10px;min-height:200px}.login-title[_ngcontent-%COMP%]{font-size:1.3rem;font-weight:500;padding-bottom:15px}button[_ngcontent-%COMP%]{border-radius:5px}"]});let i=e;return i})();var St=[{path:"",component:ut},{path:"**",redirectTo:""}],ft=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=x({type:e}),e.\u0275inj=v({imports:[C.forChild(St),C]});let i=e;return i})();var ee=(()=>{let e=class e{};e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=x({type:e}),e.\u0275inj=v({imports:[A,ft,W,J,X,dt,it,at,st,mt]});let i=e;return i})();export{ee as LoginModule};
