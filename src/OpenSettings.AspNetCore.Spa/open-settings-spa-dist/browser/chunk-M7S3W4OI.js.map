{
  "version": 3,
  "sources": ["src/app/features/tag/services/tags.service.ts"],
  "sourcesContent": ["import { HttpHeaders, HttpClient, HttpParams, HttpErrorResponse } from \"@angular/common/http\";\r\nimport { Injectable, OnDestroy } from \"@angular/core\";\r\nimport { catchError, Observable, of, Subject, takeUntil } from \"rxjs\";\r\nimport { AuthService } from \"../../../core/services/auth.service\";\r\nimport { WindowService } from \"../../../core/services/window.service\";\r\nimport { DragItemSortOrderRequest } from \"../../../shared/models/drag-item-sort-order-request\";\r\nimport { DragItemSortOrderResponse } from \"../../../shared/models/drag-item-sort-order-response\";\r\nimport { GetPaginatedRequest } from \"../../../shared/models/get-paginated-request\";\r\nimport { GetTagsRequest } from \"../models/get-tags-request\";\r\nimport { CreateTagResponse } from \"../models/create-tag-response\";\r\nimport { CreateTagRequest } from \"../models/create-tag-request\";\r\nimport { GetTagRequest } from \"../models/get-tag-request\";\r\nimport { GetTagResponse } from \"../models/get-tag-response\";\r\nimport { UpdateTagRequest } from \"../models/update-tag-request\";\r\nimport { UpdateTagResponse } from \"../models/update-tag-response\";\r\nimport { DeleteTagRequest } from \"../models/delete-tag-request\";\r\nimport { UpdateTagSortOrderRequest } from \"../models/update-tag-sort-order-request\";\r\nimport { SortDirection } from \"../../../shared/models/sort-direction.enum\";\r\nimport { IResponse, IResponseAny } from \"../../../shared/models/response\";\r\nimport { GetTagsResponse } from \"../models/get-tags-response\";\r\nimport { DeleteUnmappedItemsResponse } from \"../../../shared/models/delete-unmapped-items-response\";\r\nimport { ReorderResponse } from \"../../../shared/models/reorder-response\";\r\nimport { GetPaginatedTagsResponse } from \"../models/get-paginated-tags-response\";\r\nimport { UpdateSortOrderResponse } from \"../../../shared/models/update-sort-order-response\";\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class TagsService implements OnDestroy {\r\n    private headers: HttpHeaders = new HttpHeaders();\r\n    private route: string;\r\n    private destroy$ = new Subject<void>();\r\n\r\n    constructor(\r\n        private httpClient: HttpClient,\r\n        private authService: AuthService,\r\n        windowService: WindowService) {\r\n        this.route = windowService.controllerOptions.route;\r\n        this.authService.isAuthenticated$\r\n        .pipe(takeUntil(this.destroy$))\r\n        .subscribe(isAuthenticated => {\r\n          this.headers = isAuthenticated\r\n            ? new HttpHeaders({ 'Authorization': `${this.authService.token}` })\r\n            : new HttpHeaders();\r\n        });\r\n    }\r\n\r\n    ngOnDestroy() {\r\n        this.destroy$.next();\r\n        this.destroy$.complete();\r\n      }\r\n\r\n    getTags(request: GetTagsRequest): Observable<IResponse<GetTagsResponse>> {\r\n\r\n        let url = this.route + '/v1/tags';\r\n\r\n        let params = new HttpParams();\r\n\r\n        if (request.searchTerm) {\r\n            params = params.append(\"searchTerm\", request.searchTerm);\r\n        }\r\n\r\n        if (request.hasMappings) {\r\n            params = params.append(\"hasMappings\", request.hasMappings);\r\n        }\r\n\r\n        const queryParams = params.toString()\r\n\r\n        url += queryParams ? '?' + queryParams : '';\r\n\r\n        return this.httpClient.get<IResponse<GetTagsResponse>>(url, { headers: this.headers });\r\n    }\r\n\r\n    createTag(request: CreateTagRequest): Observable<IResponse<CreateTagResponse>> {\r\n\r\n        const url = this.route + '/v1/tags';\r\n\r\n        return this.httpClient.post<IResponse<CreateTagResponse>>(url, request.body, { headers: this.headers });\r\n    }\r\n\r\n    getPaginatedTags(request: GetPaginatedRequest): Observable<IResponse<GetPaginatedTagsResponse>> {\r\n\r\n        let url = this.route + '/v1/tags/paginated';\r\n\r\n        let params = new HttpParams();\r\n        \r\n        if (request.pageIndex) {\r\n            params = params.append(\"page\", request.pageIndex);\r\n        }\r\n\r\n        if (request.pageSize) {\r\n            params = params.append(\"size\", request.pageSize);\r\n        }\r\n\r\n        if (request.searchTerm) {\r\n            params = params.append(\"searchTerm\", request.searchTerm);\r\n        }\r\n\r\n        if (request.searchBy){\r\n            params = params.append(\"searchBy\", request.searchBy);\r\n        }\r\n\r\n        if (request.sortBy) {\r\n\r\n            params = params.append(\"sortBy\", request.sortBy);\r\n\r\n            if (request.sortDirection === SortDirection.Desc) {\r\n                params = params.append(\"sortDirection\", request.sortDirection)\r\n            }\r\n        }\r\n\r\n        const queryParams = params.toString()\r\n\r\n        url += queryParams ? '?' + queryParams : '';\r\n\r\n        return this.httpClient.get<IResponse<GetPaginatedTagsResponse>>(url, { headers: this.headers });\r\n    }\r\n\r\n    deleteUnmappedTags(): Observable<IResponse<DeleteUnmappedItemsResponse>> {\r\n\r\n        const url = this.route + '/v1/tags/unmapped';\r\n\r\n        return this.httpClient.delete<IResponse<DeleteUnmappedItemsResponse>>(url, { headers: this.headers });\r\n    }\r\n\r\n    getTagById(request: GetTagRequest): Observable<IResponse<GetTagResponse>> {\r\n\r\n        const url = this.route + '/v1/tags/' + request.tagIdOrSlug;\r\n\r\n        return this.httpClient.get<IResponse<GetTagResponse>>(url, { headers: this.headers });\r\n    }\r\n\r\n    getTagBySlug(request: GetTagRequest): Observable<IResponse<GetTagResponse>> {\r\n\r\n        const url = this.route + '/v1/tags/slug/' + request.tagIdOrSlug;\r\n\r\n        return this.httpClient.get<IResponse<GetTagResponse>>(url, { headers: this.headers });\r\n    }\r\n  \r\n    updateTag(request: UpdateTagRequest): Observable<IResponse<UpdateTagResponse>> {\r\n\r\n        const url = this.route + '/v1/tags/' + request.tagId;\r\n\r\n        return this.httpClient.put<IResponse<UpdateTagResponse>>(url, request.body, { headers: this.headers }).pipe(\r\n            catchError((response: HttpErrorResponse) => {\r\n                if (response.status === 409) {\r\n                    return of(response.error as IResponse<UpdateTagResponse>);\r\n                }\r\n\r\n                throw response;\r\n            })\r\n        );\r\n    }\r\n\r\n    deleteTag(request: DeleteTagRequest): Observable<IResponseAny> {\r\n\r\n        const url = this.route + '/v1/tags/' + request.tagId + '?rowVersion=' + encodeURIComponent(request.rowVersion);\r\n\r\n        return this.httpClient.delete<IResponseAny>(url, { headers: this.headers }).pipe(\r\n            catchError((response: HttpErrorResponse) => {\r\n                if(response.status === 409){\r\n                    return of(response.error as IResponse<IResponseAny>);\r\n                }\r\n\r\n                throw response;\r\n            })\r\n        );\r\n    }\r\n\r\n    updateTagSortOrder(request: UpdateTagSortOrderRequest): Observable<IResponse<UpdateSortOrderResponse>> {\r\n\r\n        const url = this.route + '/v1/tags/' + request.id + '/sort-order?ascent=' + request.ascent + '&rowVersion=' + encodeURIComponent(request.rowVersion);\r\n\r\n        return this.httpClient.post<IResponse<UpdateSortOrderResponse>>(url, null, { headers: this.headers }).pipe(\r\n            catchError((response: HttpErrorResponse) => {\r\n                if(response.status === 409){\r\n                    return of(response.error as IResponse<UpdateSortOrderResponse>);\r\n                }\r\n\r\n                throw response;\r\n            })\r\n        );\r\n    }\r\n\r\n    dragTag(request: DragItemSortOrderRequest): Observable<IResponse<DragItemSortOrderResponse>> {\r\n\r\n        const url = this.route + '/v1/tags/' + request.sourceId + '/drag/' + request.targetId + '?ascent=' + request.ascent + '&sourceRowVersion=' + encodeURIComponent(request.sourceRowVersion);\r\n\r\n        return this.httpClient.post<IResponse<DragItemSortOrderResponse>>(url, null, { headers: this.headers }).pipe(\r\n            catchError((response: HttpErrorResponse) => {\r\n                if(response.status === 409){\r\n                    return of(response.error as IResponse<DragItemSortOrderResponse>);\r\n                }\r\n\r\n                throw response;\r\n            })\r\n        );\r\n    }\r\n\r\n    reorder() {\r\n\r\n        const url = this.route + '/v1/tags/reorder';\r\n\r\n        return this.httpClient.post<IResponse<ReorderResponse>>(url, null, { headers: this.headers }).pipe(\r\n            catchError((response: HttpErrorResponse) => {\r\n                if(response.status === 409){\r\n                    return of(response.error as IResponse<ReorderResponse>);\r\n                }\r\n\r\n                throw response;\r\n            })\r\n        );\r\n    }\r\n}"],
  "mappings": "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",
  "names": []
}
